
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Utility library for faster, easier, and more reliable data analysis">
      
      
      
      
        <link rel="canonical" href="https://eshinjolly.com/utilz/api/ops/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.1">
    
    
      
        <title>Operations - Utilz</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9299cb39.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utilzops" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Utilz" class="md-header__button md-logo" aria-label="Utilz" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Utilz
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Operations
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ejolly/utilz/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ejolly/utilz
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Utilz" class="md-nav__button md-logo" aria-label="Utilz" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Utilz
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ejolly/utilz/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ejolly/utilz
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Usage Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Usage Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fp_data_analysis/" class="md-nav__link">
        Declarative Data Analysis
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        Saving and Loading
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../verbs/" class="md-nav__link">
        Data analysis "verbs"
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guards/" class="md-nav__link">
        Guards and Decorators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        Plotting Helpers
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Operations
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utilz.ops" class="md-nav__link">
    utilz.ops
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.mapcat" class="md-nav__link">
    mapcat()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.norm_by_group" class="md-nav__link">
    norm_by_group()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.pmap" class="md-nav__link">
    pmap()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.prep" class="md-nav__link">
    prep()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.random_seed" class="md-nav__link">
    random_seed()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.splitdf" class="md-nav__link">
    splitdf()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../boilerplate/" class="md-nav__link">
        Boilerplate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../termplot/" class="md-nav__link">
        Terminal Plots (experimental)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pipe/" class="md-nav__link">
        Pipe Operator (experimental)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utilz.ops" class="md-nav__link">
    utilz.ops
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.mapcat" class="md-nav__link">
    mapcat()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.norm_by_group" class="md-nav__link">
    norm_by_group()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.pmap" class="md-nav__link">
    pmap()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.prep" class="md-nav__link">
    prep()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.random_seed" class="md-nav__link">
    random_seed()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilz.ops.splitdf" class="md-nav__link">
    splitdf()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ejolly/utilz/edit/master/docs/api/ops.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="utilzops">utilz.ops</h1>


  <div class="doc doc-object doc-module">

<a id="utilz.ops"></a>
    <div class="doc doc-contents first">

      <p>Common data operations and transformations often on pandas dataframes</p>
<hr />



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.mapcat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mapcat</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">iterme</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_arr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p><strong>map</strong>s <code>func</code> to <code>iterme</code> and con<strong>cat</strong>enates the result into a single, list, DataFrame or array. <code>iterme</code> can be a list of elements, list of DataFrames, list of arrays, or list of lists. List of lists up to 2 deep will be flattened to single list.</p>
<p>A a few interesting use cases include:</p>
<ul>
<li>Passing None for the value of func acts as a shortcut to flatten nested lists.</li>
<li>Using in place of <code>map</code> acts like a call to <code>list(map(...))</code></li>
<li>Passing in <code>pd.read_csv</code> to list of files to get back a single dataframe</li>
</ul>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>func</code></td>
        <td><code>callable</code></td>
        <td><p>function to apply. If None, will attempt to flatten a nested list</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>iterme</code></td>
        <td><code>iterable</code></td>
        <td><p>an iterable for which func will be called on each element</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>as_df</code></td>
        <td><code>bool; optional</code></td>
        <td><p>combine result into a DataFrame; Default False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>as_arr</code></td>
        <td><code>bool; optional</code></td>
        <td><p>combine result into an array; Default False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>axis</code></td>
        <td><code>int; optional</code></td>
        <td><p>what axis to concatenate over; Default 0 (first)</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>ignore_index</code></td>
        <td><code>bool; optional</code></td>
        <td><p>ignore the index when combining DataFrames; Default True</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mapcat</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">iterme</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_arr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **map**s `func` to `iterme` and con**cat**enates the result into a single, list, DataFrame or array. `iterme` can be a list of elements, list of DataFrames, list of arrays, or list of lists. List of lists up to 2 deep will be flattened to single list.</span>

<span class="sd">    A a few interesting use cases include:</span>

<span class="sd">    - Passing None for the value of func acts as a shortcut to flatten nested lists.</span>
<span class="sd">    - Using in place of `map` acts like a call to `list(map(...))`</span>
<span class="sd">    - Passing in `pd.read_csv` to list of files to get back a single dataframe</span>

<span class="sd">    Args:</span>
<span class="sd">        func (callable): function to apply. If None, will attempt to flatten a nested list</span>
<span class="sd">        iterme (iterable): an iterable for which func will be called on each element</span>
<span class="sd">        as_df (bool; optional): combine result into a DataFrame; Default False</span>
<span class="sd">        as_arr (bool; optional): combine result into an array; Default False</span>
<span class="sd">        axis (int; optional): what axis to concatenate over; Default 0 (first)</span>
<span class="sd">        ignore_index (bool; optional): ignore the index when combining DataFrames; Default True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">as_df</span> <span class="ow">and</span> <span class="n">as_arr</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;as_df and as_arr cannot both be True&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">iterme</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterme</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">op</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">iterme</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">op</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">iterme</span><span class="p">)</span>

    <span class="n">op</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">as_df</span><span class="p">:</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="n">ignore_index</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">as_arr</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">AxisError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Created new axis because requested concatenation axis &gt; existing axes&quot;</span>
            <span class="p">)</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">op</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.norm_by_group" class="doc doc-heading">
<code class="highlight language-python"><span class="n">norm_by_group</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">grpcols</span><span class="p">,</span> <span class="n">valcol</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Normalize values in a column separately per group</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>input dataframe</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>grpcols</code></td>
        <td><code>str/list</code></td>
        <td><p>grouping col(s)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>valcol</code></td>
        <td><code>str</code></td>
        <td><p>value col</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>center</code></td>
        <td><code>bool</code></td>
        <td><p>mean center. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>scale</code></td>
        <td><code>bool</code></td>
        <td><p>divide by standard deviation. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">norm_by_group</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">grpcols</span><span class="p">,</span> <span class="n">valcol</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalize values in a column separately per group</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): input dataframe</span>
<span class="sd">        grpcols (str/list): grouping col(s)</span>
<span class="sd">        valcol (str): value col</span>
<span class="sd">        center (bool, optional): mean center. Defaults to True.</span>
<span class="sd">        scale (bool, optional): divide by standard deviation. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_norm</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span> <span class="o">-</span> <span class="n">dat</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scale</span><span class="p">:</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span> <span class="o">/</span> <span class="n">dat</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dat</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grpcols</span><span class="p">)[</span><span class="n">valcol</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">_norm</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.pmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">iterme</span><span class="p">,</span> <span class="n">func_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loop_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop_random_seed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Map a <code>func</code> to <code>iterme</code> using parallelization via joblib. Note the only difference between <code>pmap</code> and <code>prep</code> is that that <code>pmap</code> explicitly operates on an iterable, such that the input to <code>func</code> changes each time (each element of <code>iterme</code>); where as <code>prep</code> just repeatedely executes <code>func</code> for <code>n_iter</code> operations with optional args/kwargs that are the same for each run of <code>func</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>func</code></td>
        <td><code>Callable</code></td>
        <td><p>function to run</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>iterme</code></td>
        <td><code>Iterable</code></td>
        <td><p>an iterable for which each element will be passed to func</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>func_args</code></td>
        <td><code>list</code></td>
        <td><p>additional arguments to the function provided as a list for unnamed args or a dict for named kwargs. If None, assumes func takes no arguments excepted loop_idx_available (if its True); Default None</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>int</code></td>
        <td><p>number of cpus/threads; Default -1 (all cpus/threads)</p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>loop_idx</code></td>
        <td><code>bool</code></td>
        <td><p>whether the value of the current iteration should be passed to func as the special kwarg 'idx'. Make sure func can handle a kwarg named 'idx'. Default True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>loop_random_seed</code></td>
        <td><code>bool</code></td>
        <td><p>whether a randomly initialized seed should be passed to func as the special kwarg 'seed'. If func depends on any randomization (e.g. np.random) this should be set to True to ensure that parallel processes/threads use independent random seeds. Make sure func can handle a kwarg named 'seed' and utilize it for randomization. See example. Default False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td><code>str</code></td>
        <td><p>'processes' or 'threads'. Use 'threads' when you know you function releases Python's Global Interpreter Lock (GIL); Default 'cpus'</p></td>
        <td><code>&#39;processes&#39;</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>int</code></td>
        <td><p>joblib.Parallel verbosity. Default 0</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>Union[NoneType, int, numpy.random.mtrand.RandomState]</code></td>
        <td><p>random seed for reproducibility</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pmap</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">iterme</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">func_args</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">loop_idx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">loop_random_seed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;processes&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Map a `func` to `iterme` using parallelization via joblib. Note the only difference between `pmap` and `prep` is that that `pmap` explicitly operates on an iterable, such that the input to `func` changes each time (each element of `iterme`); where as `prep` just repeatedely executes `func` for `n_iter` operations with optional args/kwargs that are the same for each run of `func`.</span>

<span class="sd">    Args:</span>
<span class="sd">        func (callable): function to run</span>
<span class="sd">        iterme (iterable): an iterable for which each element will be passed to func</span>
<span class="sd">        func_args (list/dict/None): additional arguments to the function provided as a list for unnamed args or a dict for named kwargs. If None, assumes func takes no arguments excepted loop_idx_available (if its True); Default None</span>
<span class="sd">        n_jobs (int, optional): number of cpus/threads; Default -1 (all cpus/threads)</span>
<span class="sd">        loop_idx (bool, optional): whether the value of the current iteration should be passed to func as the special kwarg &#39;idx&#39;. Make sure func can handle a kwarg named &#39;idx&#39;. Default True</span>
<span class="sd">        loop_random_seed (bool, optional): whether a randomly initialized seed should be passed to func as the special kwarg &#39;seed&#39;. If func depends on any randomization (e.g. np.random) this should be set to True to ensure that parallel processes/threads use independent random seeds. Make sure func can handle a kwarg named &#39;seed&#39; and utilize it for randomization. See example. Default False.</span>
<span class="sd">        backend (str, optional): &#39;processes&#39; or &#39;threads&#39;. Use &#39;threads&#39; when you know you function releases Python&#39;s Global Interpreter Lock (GIL); Default &#39;cpus&#39;</span>
<span class="sd">        verbose (int): joblib.Parallel verbosity. Default 0</span>
<span class="sd">        seed (int/None): random seed for reproducibility</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="s2">&quot;threads&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;backend must be one of cpu&#39;s threads&quot;</span><span class="p">)</span>

    <span class="n">parfor</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">prefer</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
        <span class="n">seeds</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">MAX_INT</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iterme</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">func_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">loop_idx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                    <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                    <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                    <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">iterme</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">loop_idx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterme</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">iterme</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">func_args</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">iterme</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.prep" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prep</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">func_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loop_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop_random_seed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Call a <code>func</code> for <code>n_iter</code> using parallelization via <code>joblib</code>. Note the only difference between <code>pmap</code> and <code>prep</code> is that that <code>pmap</code> explicitly operates on an iterable, such that the input to <code>func</code> changes each time (each element of <code>iterme</code>); where as <code>prep</code> just repeatedely executes <code>func</code> for <code>n_iter</code> operations with optional args/kwargs that are the same for each run of <code>func</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>func</code></td>
        <td><code>callable</code></td>
        <td><p>function to run</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>func_args</code></td>
        <td><code>list/dict/None</code></td>
        <td><p>arguments to the function provided as a list for unnamed args or a dict for named kwargs. If None, assumes func takes no arguments excepted loop_idx_available (if its True); Default None</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_iter</code></td>
        <td><code>int</code></td>
        <td><p>number of iterations; Default 100</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>int</code></td>
        <td><p>number of cpus/threads; Default -1 (all cpus/threads)</p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>loop_idx</code></td>
        <td><code>bool</code></td>
        <td><p>whether the value of the current iteration should be passed to func as the special kwarg 'idx'. Make sure func can handle a kwarg named 'idx'. Default True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>loop_random_seed</code></td>
        <td><code>bool</code></td>
        <td><p>whether a randomly initialized seed should be passed to func as the special kwarg 'seed'. If func depends on any randomization (e.g. np.random) this should be set to True to ensure that parallel processes/threads use independent random seeds. Make sure func can handle a kwarg named 'seed' and utilize it for randomization. See example. Default False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td><code>str</code></td>
        <td><p>'processes' or 'threads'. Use 'threads' when you know you function releases Python's Global Interpreter Lock (GIL); Default 'cpus'</p></td>
        <td><code>&#39;processes&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress</code></td>
        <td><code>bool</code></td>
        <td><p>whether to show a tqdm progress bar note, this may be a bit inaccurate when n_jobs &gt; 1. Default True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>int</code></td>
        <td><p>joblib.Parallel verbosity. Default 0</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>int/None</code></td>
        <td><p>random seed for reproducibility</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>How to use a random seed.</p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">utilz.ops</span> <span class="kn">import</span> <span class="n">prep</span><span class="p">,</span> <span class="n">random_seed</span>
</code></pre></div>
    <p>First make sure your function handles a 'seed' keyword argument. Then initialize it with the utilz.ops.random_seed function. Finally, use it internally where you would normally make a call to np.random.</p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">boot_sum</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="s2">&quot;Sum up elements of array after resampling with replacement&quot;</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">new_seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">boot_arr</span> <span class="o">=</span> <span class="n">new_seed</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">return</span> <span class="n">boot_arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
    <p>Finally call it in a parallel fashion</p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">prep</span><span class="p">(</span><span class="n">boot_sum</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loop_random_seed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prep</span><span class="p">(</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">func_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">loop_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">loop_random_seed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Call a `func` for `n_iter` using parallelization via `joblib`. Note the only difference between `pmap` and `prep` is that that `pmap` explicitly operates on an iterable, such that the input to `func` changes each time (each element of `iterme`); where as `prep` just repeatedely executes `func` for `n_iter` operations with optional args/kwargs that are the same for each run of `func`.</span>

<span class="sd">    Args:</span>
<span class="sd">        func (callable): function to run</span>
<span class="sd">        func_args (list/dict/None): arguments to the function provided as a list for unnamed args or a dict for named kwargs. If None, assumes func takes no arguments excepted loop_idx_available (if its True); Default None</span>
<span class="sd">        n_iter (int, optional): number of iterations; Default 100</span>
<span class="sd">        n_jobs (int, optional): number of cpus/threads; Default -1 (all cpus/threads)</span>
<span class="sd">        loop_idx (bool, optional): whether the value of the current iteration should be passed to func as the special kwarg &#39;idx&#39;. Make sure func can handle a kwarg named &#39;idx&#39;. Default True</span>
<span class="sd">        loop_random_seed (bool, optional): whether a randomly initialized seed should be passed to func as the special kwarg &#39;seed&#39;. If func depends on any randomization (e.g. np.random) this should be set to True to ensure that parallel processes/threads use independent random seeds. Make sure func can handle a kwarg named &#39;seed&#39; and utilize it for randomization. See example. Default False.</span>
<span class="sd">        backend (str, optional): &#39;processes&#39; or &#39;threads&#39;. Use &#39;threads&#39; when you know you function releases Python&#39;s Global Interpreter Lock (GIL); Default &#39;cpus&#39;</span>
<span class="sd">        progress (bool): whether to show a tqdm progress bar note, this may be a bit inaccurate when n_jobs &gt; 1. Default True.</span>
<span class="sd">        verbose (int): joblib.Parallel verbosity. Default 0</span>
<span class="sd">        seed (int/None): random seed for reproducibility</span>

<span class="sd">    Examples:</span>
<span class="sd">        How to use a random seed.</span>

<span class="sd">        &gt;&gt;&gt; from utilz.ops import prep, random_seed</span>

<span class="sd">        First make sure your function handles a &#39;seed&#39; keyword argument. Then initialize it with the utilz.ops.random_seed function. Finally, use it internally where you would normally make a call to np.random.</span>

<span class="sd">        &gt;&gt;&gt; def boot_sum(arr, seed=None):</span>
<span class="sd">        &gt;&gt;&gt;     &quot;Sum up elements of array after resampling with replacement&quot;</span>
<span class="sd">        &gt;&gt;&gt;     new_seed = random_seed(seed)</span>
<span class="sd">        &gt;&gt;&gt;     boot_arr = new_seed.choice(arr, len(arr), replace=True)</span>
<span class="sd">        &gt;&gt;&gt;     return boot_arr.sum()</span>

<span class="sd">        Finally call it in a parallel fashion</span>

<span class="sd">        &gt;&gt;&gt; prep(boot_sum, [np.arange(10)], n_iter=100, loop_random_seed=True, loop_idx=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="s2">&quot;threads&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;backend must be one of cpu&#39;s threads&quot;</span><span class="p">)</span>

    <span class="n">parfor</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">prefer</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
        <span class="n">seeds</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">MAX_INT</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_iter</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">func_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">loop_idx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                    <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">loop_idx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_random_seed</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span>
                        <span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">func_args</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="n">parfor</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">**</span><span class="n">func_args</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func_args must be a list or dict&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.random_seed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Turn seed into a np.random.RandomState instance. Note: credit for this code goes entirely to <code>sklearn.utils.check_random_state</code>. Using the source here simply avoids an unecessary dependency.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>seed</code></td>
        <td><code>None, int, np.RandomState</code></td>
        <td><p>iff seed is None, return the RandomState singleton used by np.random. If seed is an int, return a new RandomState instance seeded with seed. If seed is already a RandomState instance, return it. Otherwise raise ValueError.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Turn seed into a np.random.RandomState instance. Note: credit for this code goes entirely to `sklearn.utils.check_random_state`. Using the source here simply avoids an unecessary dependency.</span>

<span class="sd">    Args:</span>
<span class="sd">        seed (None, int, np.RandomState): iff seed is None, return the RandomState singleton used by np.random. If seed is an int, return a new RandomState instance seeded with seed. If seed is already a RandomState instance, return it. Otherwise raise ValueError.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">numbers</span>

    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">mtrand</span><span class="o">.</span><span class="n">_rand</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">seed</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> cannot be used to seed a numpy.random.RandomState&quot;</span> <span class="s2">&quot; instance&quot;</span> <span class="o">%</span> <span class="n">seed</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="utilz.ops.splitdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">splitdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Split a dataframe into X and Y arrays given column names. Useful for splitting up a a pandas dataframe as a <code>sklearn</code> pipeline step. If <code>Y</code> is <code>None</code>, assumes its in the <em>first</em> column of <code>df</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>Dataframe</code></td>
        <td><p>input dataframe that's at least 2d</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>Y</code></td>
        <td><code>string</code></td>
        <td><p>name(s) of the columns for the Y array. Defaults to df.iloc[:, 0]</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>X</code></td>
        <td><code>string/list</code></td>
        <td><p>name(s) of columns for the X array. Defaults to df.iloc[:,1:]</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If df is not 2 dimensional</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>(X, Y)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>utilz/ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">splitdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split a dataframe into X and Y arrays given column names. Useful for splitting up a a pandas dataframe as a `sklearn` pipeline step. If `Y` is `None`, assumes its in the *first* column of `df`.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (Dataframe): input dataframe that&#39;s at least 2d</span>
<span class="sd">        Y (string, optional): name(s) of the columns for the Y array. Defaults to df.iloc[:, 0]</span>
<span class="sd">        X (string/list, optional): name(s) of columns for the X array. Defaults to df.iloc[:,1:]</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If df is not 2 dimensional</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (X, Y)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df must 2 dimensional&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">X</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">Y</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../plot/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Plotting Helpers
            </div>
          </div>
        </a>
      
      
        <a href="../boilerplate/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Boilerplate
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.7353b375.min.js"></script>
      
    
  </body>
</html>